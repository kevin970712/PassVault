# This is a GitHub Action to automate uploading release assets to SourceForge
name: Upload Release to SourceForge

# This action triggers WHEN publishing a new "Release" on GitHub
on:
  release:
    types: [published]

jobs:
  upload:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Download all release assets
        # This action downloads the .apk (or other files) attached to the GitHub release
        uses: cardinalby/download-github-release-assets@v1
        with:
          repo: ${{ github.repository }}
          tag: ${{ github.event.release.tag_name }}
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Upload APK to SourceForge
        # This action logs into SourceForge and uploads files
        uses: jcomeau-web/github-action-upload-to-sourceforge@v1
        with:
          user-name: ${{ secrets.SF_USERNAME }}
          user-password: ${{ secrets.SF_PASSWORD }}
          
          # This is your SourceForge project's "unixname" 
          project-name: 'passvault-app' 
          
          # This tells it to upload any file ending in .apk that it just downloaded
          source-file: '*.apk' 
          
          # This creates a new folder on SourceForge named after tag (e.g., /v0.2-alpha/)
          target-path: '/${{ github.event.release.tag_name }}/'
